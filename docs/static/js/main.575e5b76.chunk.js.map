{"version":3,"sources":["data.js","style.js","music.js","audio.js","../../src/constant.ts","../../src/util/parse_lrc.ts","../../src/component/blank.tsx","../../src/component/lrc.tsx","../../src/hook/use_auto_scroll.ts","../../src/hook/use_lrc.ts","../../src/hook/use_lrc_line_offset_top_map.ts","../../src/component/lrc_wrapper.tsx","../../src/component/lrc_line.tsx","lyric.js","app.js","index.js"],"names":["id","cover","singers","name","album","src","lrc","container","position","width","height","top","left","display","alignItems","part","flex","audio","margin","Style","styled","div","playing","Music","music","onPlay","alt","className","join","type","onClick","Audio","onPrevious","onNext","onTimeUpdate","audioRef","useRef","useCallback","current","play","onPause","pause","title","artist","artwork","sizes","onPreviousTrack","onNextTrack","autoPlay","loop","controls","style","ref","LRC_LINE_CLASS_NAME","Math","LRC_LINE","LRC_TIMESTAMP_WITH_BRACKET","LRC_TIMESTAMP","lrcLineList","line","timeStringList","content","timeString","minute","second","millisecond","Number","a","b","Blank","Lrc","currentTime","children","autoScrollAfterUserScroll","AUTO_SCROLL_AFTER_USER_SCROLL","onCurrentLineChange","scrollToCurrentLineSymbol","props","rootRef","autoScroll","useState","setAutoScroll","useLayoutEffect","wheelListener","clearTimeout","timer","setTimeout","useEffect","useAutoScroll","currentIndex","setCurrentIndex","parseLrc","setLrcLineList","useLrc","lrcLineOffsetTopMap","map","calculate","lineList","document","i","length","rect","windowResizeListener","window","useLrcLineOffsetTopMap","behavior","lrcLine","index","LrcWrapper","currentLrcLine","currentLrcLineIndex","scrollToCurrentLine","this","getCurrentLine","state","render","PureComponent","LrcLine","wrapper","flexDirection","padding","textAlign","fontSize","Wrapper","lrcRef","alert","JSON","stringify","console","log","active","key","color","App","setIndex","target","musicList","setCurrentTime","event","m","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.575e5b76.chunk.js","sourcesContent":["export default [\n  {\n    id: 2,\n    cover: './source/d0c670fed000d3330cf26f704b4e7a86.jpeg',\n    singers: ['Cailin Russo', 'Chrissy Costanza'],\n    name: 'Phoenix',\n    album: 'Phoenix',\n    src: './source/Cailin Russo,Chrissy Costanza - Phoenix.m4a',\n    lrc: `[00:11.89]What are you willing to lose\n[00:13.73]You cover your wounds but underneath them\n[00:17.74]A million voices in your head that whisper \"Stop now\"\n[00:23.38]Another twist of the knife turn of the screws\n[00:26.60]It's all in your mind and it's fighting you\n[00:30.33]Arm yourself a storm is coming\n[00:33.63]Well kid\n[00:34.94]What you gonna do now\n[00:40.84]It's your reflection looking back to pull you down\n[00:46.44]So are you gonna die today or make it out alive\n[00:51.96]You gotta conquer the monster in your head and then you'll fly\n[00:56.82]Fly Phoenix fly\n[01:00.31]It's time for a new empire\n[01:02.81]Go bury your demons then tear down the ceiling\n[01:08.47]Phoenix fly\n[01:14.86]And now you're playing with matches come out of the ashes\n[01:18.24]Underneath you a million voices in the crowd they're screaming \"Stop now\"\n[01:26.28]Well let 'em swallow their pride you're turning the tide to true believers\n[01:32.01]Got them in the palm of your hand you're playing God now\n[01:37.86]What you gonna do now\n[01:43.65]It's your reflection looking back to pull you down\n[01:49.32]So are you gonna die today or make it out alive\n[01:54.77]You gotta conquer the monster in your head and then you'll fly\n[01:59.74]Fly Phoenix fly\n[02:03.10]It's time for a new empire\n[02:05.68]Go bury your demons then tear down the ceiling\n[02:11.32]Phoenix fly\n[02:16.65]What you gonna do now\n[02:20.84]What you gonna do now\n[02:46.58]So are you gonna die today or make it out alive\n[02:52.06]You gotta conquer the monster in your head and then you'll fly\n[02:56.83]Fly Phoenix fly\n[03:00.22]It's time for a new empire\n[03:02.90]Go bury your demons then tear down the ceiling\n[03:08.52]Phoenix fly`,\n  },\n  {\n    id: 1,\n    cover: './source/b5d358e6c54c15bf0d80ad288aba377b.jpeg',\n    singers: ['陈蕾'],\n    name: '当我迷失时听着的歌',\n    album: '当我迷失时听着的歌',\n    src: './source/陈蕾 - 当我迷失时听着的歌.mp3',\n    lrc: `[00:28.41]为着什么追赶到头来有变质吗\n[00:35.34]日夜扮演开心角色吗 却总一个面对\n[00:42.41]一个 流浪哪一街角找哪份寄托\n[00:49.02]一个 闹市中却只得我\n[00:55.49]这刹那却想到至亲的说话\n[01:02.14]如若迷失请谨记回家\n[01:06.19]迷路不要惊怕\n[01:08.95]前路难关都给你招架\n[01:12.83]如像孩子那样靠着我不怕\n[01:19.72]好好的放一假\n[01:23.76]重整理内心积压再出发\n[01:36.13]望着父亲不经已白头发也斑斑\n[01:42.66]家中每一位都尚好吗 我不敢致电你\n[01:49.90]生怕 提及我的一切可会令你心挂\n[01:56.77]生怕 说到声线变沙哑\n[02:03.00]还未成功不敢说回家\n[02:06.97]要再打拼一下\n[02:09.79]同学们纷纷都已出嫁\n[02:13.76]仍在留守这地 努力往上爬\n[02:20.64]多少风雨洗刷\n[02:24.60]还可有力气抵抗吗\n[02:30.01]要记住回头看现状\n[02:33.74]会发现已过三关斩了六将\n[02:41.62]曾亦有灰色思绪在扩张\n[02:46.45]你却是往日灿烂模样\n[02:49.65]默默地为我在燃亮\n[03:21.01]如若迷失请谨记回家\n[03:24.91]迷路不再惊怕\n[03:27.57]前路难关都给我招架\n[03:31.50]犹幸能得你护荫 做你 亲手栽种的花\n[03:39.34]若跌倒纵使满身伤痕沉沦在流沙\n[03:46.08]我都不怕\n[03:47.08]也得你的双手引路回家\n[03:55.80]再都不怕`,\n  },\n];\n","export default {\n  container: {\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    top: 0,\n    left: 0,\n    display: 'flex',\n    alignItems: 'center',\n  },\n  part: {\n    flex: 1,\n  },\n  audio: {\n    width: '100%',\n    margin: '20px 0',\n  },\n};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Style = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: ${({ playing }) =>\n    playing ? 'rgba(49, 194, 124, 0.2)' : 'white'};\n  > .cover {\n    width: 60px;\n    height: 60px;\n  }\n  > .info {\n    flex: 1;\n    min-width: 0;\n    margin-left: 20px;\n    > .name {\n      font-size: 14px;\n    }\n    > .singers {\n      font-size: 12px;\n      color: gray;\n    }\n  }\n`;\n\nconst Music = ({ music, playing, onPlay }) => {\n  return (\n    <Style playing={playing}>\n      <img src={music.cover} alt=\"cover\" className=\"cover\" />\n      <div className=\"info\">\n        <div className=\"name\">{music.name}</div>\n        <div className=\"singers\">{music.singers.join(',')}</div>\n        <div className=\"actions\">\n          <button type=\"button\" onClick={() => onPlay(music)}>\n            {playing ? 'playing' : 'play'}\n          </button>\n        </div>\n      </div>\n    </Style>\n  );\n};\n\nexport default Music;\n","import React, { useRef, useCallback } from 'react';\nimport MediaSession from '@mebtte/react-media-session';\n\nimport style from './style';\n\nconst Audio = ({ music, onPrevious, onNext, onTimeUpdate }) => {\n  const audioRef = useRef();\n  const onPlay = useCallback(() => audioRef.current.play(), []);\n  const onPause = useCallback(() => audioRef.current.pause(), []);\n\n  return (\n    <MediaSession\n      title={music.name}\n      artist={music.singers.join(',')}\n      artwork={[\n        {\n          src: music.cover,\n          sizes: '512x512',\n        },\n      ]}\n      onPlay={onPlay}\n      onPause={onPause}\n      onPreviousTrack={onPrevious}\n      onNextTrack={onNext}\n    >\n      <audio\n        src={music.src}\n        autoPlay\n        loop\n        controls\n        style={style.audio}\n        ref={audioRef}\n        onTimeUpdate={onTimeUpdate}\n      />\n    </MediaSession>\n  );\n};\n\nexport default Audio;\n","export const AUTO_SCROLL_AFTER_USER_SCROLL = 5000;\n\nexport const LRC_LINE_CLASS_NAME = `react_lrc_line_${Math.random()\n  .toString(36)\n  .substring(7)}`;\n\nexport const RESIZE_INTERVAL = 1000;\n\nexport const ININIAL_LRC_LINE_INDEX = -1;\n","import { LrcLine } from '../type';\n\nconst LRC_LINE = /^(\\[[0-9]+:[0-9]+(\\.[0-9]+)?\\])+.*/;\nconst LRC_TIMESTAMP_WITH_BRACKET = /\\[[0-9]+:[0-9]+(\\.[0-9]+)?\\]/g;\nconst LRC_TIMESTAMP = /[0-9]+/g;\n\nexport default (lrc: string): LrcLine[] => {\n  const lrcLineList: LrcLine[] = [];\n  const lineList = lrc.split('\\n');\n  for (const line of lineList) {\n    if (!LRC_LINE.test(line)) {\n      continue;\n    }\n    const timeStringList = line.match(LRC_TIMESTAMP_WITH_BRACKET) as string[];\n    const content = line.replace(LRC_TIMESTAMP_WITH_BRACKET, '');\n    for (const timeString of timeStringList) {\n      const [minute, second, millisecond = '0'] = timeString.match(\n        LRC_TIMESTAMP,\n      ) as string[];\n      lrcLineList.push({\n        millisecond:\n          Number.parseInt(minute, 10) * 60 * 1000 +\n          Number.parseInt(second, 10) * 1000 +\n          Number.parseInt(millisecond, 10),\n        content,\n      });\n    }\n  }\n  return lrcLineList.sort((a, b) => a.millisecond - b.millisecond);\n};\n","import React from 'react';\n\nconst Blank = ({ height }: { height: string | number }) => (\n  <div style={{ height }} />\n);\n\nexport default Blank;\n","import React, { useState, useRef, useLayoutEffect, useEffect } from 'react';\n\nimport { LrcProps } from '../type';\nimport { AUTO_SCROLL_AFTER_USER_SCROLL } from '../constant';\nimport useLrc from '../hook/use_lrc';\nimport useLrcLineOffsetTopMap from '../hook/use_lrc_line_offset_top_map';\nimport useAutoScroll from '../hook/use_auto_scroll';\n\nimport Blank from './blank';\n\ninterface Props extends LrcProps {\n  scrollToCurrentLineSymbol: number;\n}\n\nconst Lrc = ({\n  lrc,\n  currentTime = 0,\n  children,\n  autoScrollAfterUserScroll = AUTO_SCROLL_AFTER_USER_SCROLL,\n  onCurrentLineChange,\n  scrollToCurrentLineSymbol,\n  ...props\n}: Props) => {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const autoScroll = useAutoScroll({\n    rootRef,\n    autoScrollAfterUserScroll,\n    scrollToCurrentLineSymbol,\n  });\n  const [currentIndex, setCurrentIndex] = useState<number>(-1);\n  const lrcLineList = useLrc(lrc);\n  const lrcLineOffsetTopMap = useLrcLineOffsetTopMap({ lrcLineList, rootRef });\n\n  useLayoutEffect(() => {\n    const { length } = lrcLineList;\n    let i = 0;\n    for (; i < length; i += 1) {\n      const { millisecond } = lrcLineList[i];\n      if (currentTime < millisecond) {\n        break;\n      }\n    }\n    setCurrentIndex(i - 1);\n  }, [currentTime, lrcLineList]);\n\n  useLayoutEffect(() => {\n    if (autoScroll) {\n      rootRef.current?.scrollTo({\n        left: 0,\n        top:\n          (lrcLineOffsetTopMap.get(currentIndex) || 0) -\n          (lrcLineOffsetTopMap.get(Infinity) || 0) / 2,\n        behavior: 'smooth',\n      });\n    }\n  }, [currentIndex, autoScroll]);\n  useEffect(() => {\n    if (onCurrentLineChange) {\n      onCurrentLineChange(lrcLineList[currentIndex] || null, currentIndex);\n    }\n  }, [currentIndex, lrcLineList, onCurrentLineChange]);\n\n  return (\n    <div {...props} ref={rootRef}>\n      <Blank height=\"45%\" />\n      {lrcLineList.map((lrcLine, index) =>\n        children(lrcLine, index === currentIndex, index),\n      )}\n      <Blank height=\"50%\" />\n    </div>\n  );\n};\n\nexport default Lrc;\n","import { useLayoutEffect, useState, RefObject, useEffect } from 'react';\n\nexport default ({\n  rootRef,\n  autoScrollAfterUserScroll,\n  scrollToCurrentLineSymbol,\n}: {\n  rootRef: RefObject<HTMLDivElement>;\n  autoScrollAfterUserScroll: number;\n  scrollToCurrentLineSymbol: number;\n}) => {\n  const [autoScroll, setAutoScroll] = useState(true);\n\n  useLayoutEffect(() => {\n    (rootRef.current as HTMLDivElement).style.overflow = 'auto';\n  }, []);\n\n  useLayoutEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n    const wheelListener = () => {\n      setAutoScroll(false);\n      clearTimeout(timer);\n      timer = setTimeout(() => setAutoScroll(true), autoScrollAfterUserScroll);\n    };\n    (rootRef.current as HTMLDivElement).addEventListener(\n      'wheel',\n      wheelListener,\n    );\n    return () =>\n      (rootRef.current as HTMLDivElement).removeEventListener(\n        'wheel',\n        wheelListener,\n      );\n  }, [autoScrollAfterUserScroll]);\n\n  useEffect(() => {\n    setAutoScroll(true);\n  }, [scrollToCurrentLineSymbol]);\n\n  return autoScroll;\n};\n","import { useState, useEffect } from 'react';\n\nimport { LrcLine } from '../type';\nimport parseLrc from '../util/parse_lrc';\n\nexport default (lrc: string) => {\n  const [lrcLineList, setLrcLineList] = useState<LrcLine[]>(parseLrc(lrc));\n\n  useEffect(() => {\n    setLrcLineList(parseLrc(lrc));\n  }, [lrc]);\n\n  return lrcLineList;\n};\n","import {\n  useRef,\n  useLayoutEffect,\n  RefObject,\n  useEffect,\n  useCallback,\n} from 'react';\nimport { LrcLine } from '../type';\n\nimport { LRC_LINE_CLASS_NAME, RESIZE_INTERVAL } from '../constant';\n\nexport default ({\n  lrcLineList,\n  rootRef,\n}: {\n  lrcLineList: LrcLine[];\n  rootRef: RefObject<HTMLDivElement>;\n}) => {\n  const map = useRef<Map<number, number>>(new Map());\n  const calculate = useCallback(() => {\n    map.current = new Map();\n    const lineList = document.querySelectorAll(`.${LRC_LINE_CLASS_NAME}`);\n    for (let i = 0, { length } = lineList; i < length; i += 1) {\n      const line = lineList[i] as HTMLDivElement;\n      map.current.set(i, line.offsetTop);\n    }\n    const rect = rootRef.current?.getBoundingClientRect();\n    map.current.set(Infinity, rect?.height || 0);\n  }, []);\n\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n    const windowResizeListener = () => {\n      clearTimeout(timer);\n      timer = setTimeout(calculate, RESIZE_INTERVAL);\n    };\n    window.addEventListener('resize', windowResizeListener);\n    return () => window.removeEventListener('resize', windowResizeListener);\n  }, [calculate]);\n\n  useLayoutEffect(() => {\n    calculate();\n  }, [lrcLineList]);\n\n  return map.current;\n};\n","import React, { PureComponent } from 'react';\n\nimport { LrcProps, LrcLine } from '../type';\nimport { ININIAL_LRC_LINE_INDEX } from '../constant';\n\nimport Lrc from './lrc';\n\nclass LrcWrapper extends PureComponent<\n  LrcProps,\n  {\n    scrollToCurrentLineSymbol: number;\n    currentLrcLine: LrcLine | null;\n    currentLrcLineIndex: number;\n  }\n> {\n  constructor(props: LrcProps) {\n    super(props);\n    this.state = {\n      scrollToCurrentLineSymbol: 0,\n      currentLrcLine: null,\n      currentLrcLineIndex: ININIAL_LRC_LINE_INDEX,\n    };\n    this.onCurrentLineChange = this.onCurrentLineChange.bind(this);\n  }\n\n  scrollToCurrentLine() {\n    this.setState({ scrollToCurrentLineSymbol: Math.random() });\n  }\n\n  getCurrentLine(): {\n    lrcLine: LrcLine | null;\n    index: number;\n  } {\n    const { currentLrcLine, currentLrcLineIndex } = this.state;\n    return {\n      lrcLine: currentLrcLine,\n      index: currentLrcLineIndex,\n    };\n  }\n\n  private onCurrentLineChange(lrcLine: LrcLine, index: number) {\n    const { onCurrentLineChange } = this.props;\n    this.setState(\n      {\n        currentLrcLine: lrcLine,\n        currentLrcLineIndex: index,\n      },\n      () => {\n        if (onCurrentLineChange) {\n          onCurrentLineChange(lrcLine, index);\n        }\n      },\n    );\n  }\n\n  render() {\n    const { scrollToCurrentLineSymbol } = this.state;\n    return (\n      <Lrc\n        {...this.props}\n        onCurrentLineChange={this.onCurrentLineChange}\n        scrollToCurrentLineSymbol={scrollToCurrentLineSymbol}\n      />\n    );\n  }\n}\n\nexport default LrcWrapper;\n","import React from 'react';\n\nimport { LRC_LINE_CLASS_NAME } from '../constant';\n\nconst LrcLine = ({\n  className = '',\n  ...props\n}: {\n  className?: string;\n  [key: string]: any;\n}) => {\n  return (\n    <div {...props} className={`${LRC_LINE_CLASS_NAME} ${className}`}>\n      {props.children}\n    </div>\n  );\n};\n\nexport default LrcLine;\n","import React, { useRef, useCallback } from 'react';\nimport { Lrc, LrcLine } from '@mebtte/react-lrc';\n\nconst style = {\n  wrapper: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  lrc: {\n    flex: 1,\n    padding: 20,\n  },\n  line: {\n    textAlign: 'center',\n    padding: 10,\n    fontSize: 16,\n  },\n};\n\nconst Wrapper = ({ music, currentTime }) => {\n  const lrcRef = useRef();\n  const scrollToCurrentLine = useCallback(\n    () => lrcRef.current.scrollToCurrentLine(),\n    [],\n  );\n  const getCurrentLine = useCallback(() => {\n    // eslint-disable-next-line no-undef\n    alert(JSON.stringify(lrcRef.current.getCurrentLine()));\n  }, []);\n  const onCurrentLineChange = useCallback((lrcLine, index) => {\n    console.log('\\n');\n    console.log(lrcLine, index);\n  }, []);\n\n  return (\n    <div style={style.wrapper}>\n      <div className=\"actions\">\n        <button type=\"button\" onClick={scrollToCurrentLine}>\n          scroll to current line\n        </button>\n        <button type=\"button\" onClick={getCurrentLine}>\n          alert current line\n        </button>\n      </div>\n      <Lrc\n        lrc={music.lrc}\n        currentTime={currentTime * 1000}\n        onCurrentLineChange={onCurrentLineChange}\n        style={style.lrc}\n        ref={lrcRef}\n      >\n        {(line, active) => (\n          <LrcLine\n            key={line.millisecond}\n            style={{\n              ...style.line,\n              color: active ? 'red' : 'gray',\n            }}\n          >\n            {line.content}\n          </LrcLine>\n        )}\n      </Lrc>\n    </div>\n  );\n};\n\nexport default Wrapper;\n","import React, { useState, useCallback } from 'react';\n\nimport musicList from './data';\nimport style from './style';\n\nimport Music from './music';\nimport Audio from './audio';\nimport Lyric from './lyric';\n\nconst App = () => {\n  const [index, setIndex] = useState(0);\n  const onPrevious = useCallback(\n    () =>\n      setIndex((i) => {\n        const target = i - 1;\n        if (target < 0) {\n          return target + musicList.length;\n        }\n        return target;\n      }),\n    [],\n  );\n  const onNext = useCallback(\n    () => setIndex((i) => (i + 1) % musicList.length),\n    [],\n  );\n  const [currentTime, setCurrentTime] = useState(0);\n  const onTimeUpdate = useCallback(\n    (event) => setCurrentTime(event.target.currentTime),\n    [],\n  );\n\n  const music = musicList[index];\n  return (\n    <div style={style.container}>\n      <div style={style.part}>\n        {musicList.map((m, i) => (\n          <Music\n            key={m.id}\n            music={m}\n            playing={i === index}\n            onPlay={() => setIndex(i)}\n          />\n        ))}\n        <Audio\n          music={music}\n          onPrevious={onPrevious}\n          onNext={onNext}\n          onTimeUpdate={onTimeUpdate}\n        />\n      </div>\n      <Lyric music={music} currentTime={currentTime} />\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}