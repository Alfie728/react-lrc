{"version":3,"sources":["data.js","style.js","music.js","audio.js","../../src/constant.ts","../../src/util/parse_lrc.ts","../../src/component/blank.tsx","../../src/component/lrc.tsx","../../src/hook/use_auto_scroll.ts","../../src/hook/use_lrc.ts","../../src/hook/use_lrc_line_offset_top_map.ts","../../src/component/lrc_wrapper.tsx","../../src/component/lrc_line.tsx","lyric.js","app.js","index.js"],"names":["id","cover","singers","name","album","src","lrc","container","position","width","height","top","left","display","alignItems","part","flex","audio","margin","Style","styled","div","playing","Music","music","onPlay","alt","className","join","type","onClick","Audio","onPrevious","onNext","onTimeUpdate","audioRef","useRef","useCallback","current","play","onPause","pause","title","artist","artwork","sizes","onPreviousTrack","onNextTrack","autoPlay","loop","controls","style","ref","LRC_LINE_CLASS_NAME","Math","LRC_LINE","LRC_TIMESTAMP_WITH_BRACKET","LRC_TIMESTAMP","lrcLineList","lineList","timeStringList","line","content","timeString","millisecond","Number","a","b","Blank","Lrc","currentTime","autoScrollAfterUserScroll","props","rootRef","autoScroll","scrollToCurrentLineSymbol","useState","useLayoutEffect","wheelListener","setAutoScroll","clearTimeout","timer","setTimeout","useEffect","useAutoScroll","parseLrc","setLrcLineList","useLrc","lrcLineOffsetTopMap","map","calculate","document","i","length","rect","windowResizeListener","window","useLrcLineOffsetTopMap","setCurrentIndex","behavior","currentIndex","onCurrentLineChange","React","children","lrcLine","index","constructor","currentLrcLine","currentLrcLineIndex","this","LrcLine","wrapper","flexDirection","padding","textAlign","fontSize","Wrapper","lrcRef","scrollToCurrentLine","getCurrentLine","alert","JSON","stringify","console","log","active","key","color","App","setIndex","target","musicList","setCurrentTime","event","m","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.1d7d7bef.chunk.js","sourcesContent":["export default [\n  {\n    id: 2,\n    cover: './source/d0c670fed000d3330cf26f704b4e7a86.jpeg',\n    singers: ['Cailin Russo', 'Chrissy Costanza'],\n    name: 'Phoenix',\n    album: 'Phoenix',\n    src: './source/Cailin Russo,Chrissy Costanza - Phoenix.m4a',\n    lrc: `[00:11.89]What are you willing to lose\n[00:13.73]You cover your wounds but underneath them\n[00:17.74]A million voices in your head that whisper \"Stop now\"\n[00:23.38]Another twist of the knife turn of the screws\n[00:26.60]It's all in your mind and it's fighting you\n[00:30.33]Arm yourself a storm is coming\n[00:33.63]Well kid\n[00:34.94]What you gonna do now\n[00:40.84]It's your reflection looking back to pull you down\n[00:46.44]So are you gonna die today or make it out alive\n[00:51.96]You gotta conquer the monster in your head and then you'll fly\n[00:56.82]Fly Phoenix fly\n[01:00.31]It's time for a new empire\n[01:02.81]Go bury your demons then tear down the ceiling\n[01:08.47]Phoenix fly\n[01:14.86]And now you're playing with matches come out of the ashes\n[01:18.24]Underneath you a million voices in the crowd they're screaming \"Stop now\"\n[01:26.28]Well let 'em swallow their pride you're turning the tide to true believers\n[01:32.01]Got them in the palm of your hand you're playing God now\n[01:37.86]What you gonna do now\n[01:43.65]It's your reflection looking back to pull you down\n[01:49.32]So are you gonna die today or make it out alive\n[01:54.77]You gotta conquer the monster in your head and then you'll fly\n[01:59.74]Fly Phoenix fly\n[02:03.10]It's time for a new empire\n[02:05.68]Go bury your demons then tear down the ceiling\n[02:11.32]Phoenix fly\n[02:16.65]What you gonna do now\n[02:20.84]What you gonna do now\n[02:46.58]So are you gonna die today or make it out alive\n[02:52.06]You gotta conquer the monster in your head and then you'll fly\n[02:56.83]Fly Phoenix fly\n[03:00.22]It's time for a new empire\n[03:02.90]Go bury your demons then tear down the ceiling\n[03:08.52]Phoenix fly`,\n  },\n  {\n    id: 1,\n    cover: './source/b5d358e6c54c15bf0d80ad288aba377b.jpeg',\n    singers: ['陈蕾'],\n    name: '当我迷失时听着的歌',\n    album: '当我迷失时听着的歌',\n    src: './source/陈蕾 - 当我迷失时听着的歌.mp3',\n    lrc: `[00:28.41]为着什么追赶到头来有变质吗\n[00:35.34]日夜扮演开心角色吗 却总一个面对\n[00:42.41]一个 流浪哪一街角找哪份寄托\n[00:49.02]一个 闹市中却只得我\n[00:55.49]这刹那却想到至亲的说话\n[01:02.14]如若迷失请谨记回家\n[01:06.19]迷路不要惊怕\n[01:08.95]前路难关都给你招架\n[01:12.83]如像孩子那样靠着我不怕\n[01:19.72]好好的放一假\n[01:23.76]重整理内心积压再出发\n[01:36.13]望着父亲不经已白头发也斑斑\n[01:42.66]家中每一位都尚好吗 我不敢致电你\n[01:49.90]生怕 提及我的一切可会令你心挂\n[01:56.77]生怕 说到声线变沙哑\n[02:03.00]还未成功不敢说回家\n[02:06.97]要再打拼一下\n[02:09.79]同学们纷纷都已出嫁\n[02:13.76]仍在留守这地 努力往上爬\n[02:20.64]多少风雨洗刷\n[02:24.60]还可有力气抵抗吗\n[02:30.01]要记住回头看现状\n[02:33.74]会发现已过三关斩了六将\n[02:41.62]曾亦有灰色思绪在扩张\n[02:46.45]你却是往日灿烂模样\n[02:49.65]默默地为我在燃亮\n[03:21.01]如若迷失请谨记回家\n[03:24.91]迷路不再惊怕\n[03:27.57]前路难关都给我招架\n[03:31.50]犹幸能得你护荫 做你 亲手栽种的花\n[03:39.34]若跌倒纵使满身伤痕沉沦在流沙\n[03:46.08]我都不怕\n[03:47.08]也得你的双手引路回家\n[03:55.80]再都不怕`,\n  },\n];\n","export default {\n  container: {\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    top: 0,\n    left: 0,\n    display: 'flex',\n    alignItems: 'center',\n  },\n  part: {\n    flex: 1,\n  },\n  audio: {\n    width: '100%',\n    margin: '20px 0',\n  },\n};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Style = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  background-color: ${({ playing }) =>\n    playing ? 'rgba(49, 194, 124, 0.2)' : 'white'};\n  > .cover {\n    width: 60px;\n    height: 60px;\n  }\n  > .info {\n    flex: 1;\n    min-width: 0;\n    margin-left: 20px;\n    > .name {\n      font-size: 14px;\n    }\n    > .singers {\n      font-size: 12px;\n      color: gray;\n    }\n  }\n`;\n\nconst Music = ({ music, playing, onPlay }) => {\n  return (\n    <Style playing={playing}>\n      <img src={music.cover} alt=\"cover\" className=\"cover\" />\n      <div className=\"info\">\n        <div className=\"name\">{music.name}</div>\n        <div className=\"singers\">{music.singers.join(',')}</div>\n        <div className=\"actions\">\n          <button type=\"button\" onClick={() => onPlay(music)}>\n            {playing ? 'playing' : 'play'}\n          </button>\n        </div>\n      </div>\n    </Style>\n  );\n};\n\nexport default Music;\n","import React, { useRef, useCallback } from 'react';\nimport MediaSession from '@mebtte/react-media-session';\n\nimport style from './style';\n\nconst Audio = ({ music, onPrevious, onNext, onTimeUpdate }) => {\n  const audioRef = useRef();\n  const onPlay = useCallback(() => audioRef.current.play(), []);\n  const onPause = useCallback(() => audioRef.current.pause(), []);\n\n  return (\n    <MediaSession\n      title={music.name}\n      artist={music.singers.join(',')}\n      artwork={[\n        {\n          src: music.cover,\n          sizes: '512x512',\n        },\n      ]}\n      onPlay={onPlay}\n      onPause={onPause}\n      onPreviousTrack={onPrevious}\n      onNextTrack={onNext}\n    >\n      <audio\n        src={music.src}\n        autoPlay\n        loop\n        controls\n        style={style.audio}\n        ref={audioRef}\n        onTimeUpdate={onTimeUpdate}\n      />\n    </MediaSession>\n  );\n};\n\nexport default Audio;\n","export const AUTO_SCROLL_AFTER_USER_SCROLL = 5000;\n\nexport const LRC_LINE_CLASS_NAME = `react_lrc_line_${Math.random()\n  .toString(36)\n  .substring(7)}`;\n\nexport const RESIZE_INTERVAL = 1000;\n\nexport const ININIAL_LRC_LINE_INDEX = -1;\n","import { LrcLine } from '../type';\n\nconst LRC_LINE = /^(\\[[0-9]+:[0-9]+(\\.[0-9]+)?\\])+.*/;\nconst LRC_TIMESTAMP_WITH_BRACKET = /\\[[0-9]+:[0-9]+(\\.[0-9]+)?\\]/g;\nconst LRC_TIMESTAMP = /[0-9]+/g;\n\nexport default (lrc: string): LrcLine[] => {\n  const lrcLineList: LrcLine[] = [];\n  const lineList = lrc.split('\\n');\n  for (const line of lineList) {\n    if (!LRC_LINE.test(line)) {\n      continue;\n    }\n    const timeStringList = line.match(LRC_TIMESTAMP_WITH_BRACKET) as string[];\n    const content = line.replace(LRC_TIMESTAMP_WITH_BRACKET, '');\n    for (const timeString of timeStringList) {\n      const [minute, second, millisecond = '0'] = timeString.match(\n        LRC_TIMESTAMP,\n      ) as string[];\n      lrcLineList.push({\n        millisecond:\n          Number.parseInt(minute, 10) * 60 * 1000 +\n          Number.parseInt(second, 10) * 1000 +\n          Number.parseInt(millisecond, 10),\n        content,\n      });\n    }\n  }\n  return lrcLineList.sort((a, b) => a.millisecond - b.millisecond);\n};\n","import React from 'react';\n\nconst Blank = () => <div style={{ height: '50%' }} />;\n\nexport default Blank;\n","import React, { useState, useRef, useLayoutEffect, useEffect } from 'react';\n\nimport { LrcProps } from '../type';\nimport { AUTO_SCROLL_AFTER_USER_SCROLL } from '../constant';\nimport useLrc from '../hook/use_lrc';\nimport useLrcLineOffsetTopMap from '../hook/use_lrc_line_offset_top_map';\nimport useAutoScroll from '../hook/use_auto_scroll';\n\nimport Blank from './blank';\n\ninterface Props extends LrcProps {\n  scrollToCurrentLineSymbol: number;\n}\n\nconst Lrc = ({\n  lrc,\n  currentTime = 0,\n  children,\n  autoScrollAfterUserScroll = AUTO_SCROLL_AFTER_USER_SCROLL,\n  onCurrentLineChange,\n  scrollToCurrentLineSymbol,\n  ...props\n}: Props) => {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const autoScroll = useAutoScroll({\n    rootRef,\n    autoScrollAfterUserScroll,\n    scrollToCurrentLineSymbol,\n  });\n  const [currentIndex, setCurrentIndex] = useState<number>(-1);\n  const lrcLineList = useLrc(lrc);\n  const lrcLineOffsetTopMap = useLrcLineOffsetTopMap({ lrcLineList, rootRef });\n\n  useLayoutEffect(() => {\n    const { length } = lrcLineList;\n    let i = 0;\n    for (; i < length; i += 1) {\n      const { millisecond } = lrcLineList[i];\n      if (currentTime < millisecond) {\n        break;\n      }\n    }\n    setCurrentIndex(i - 1);\n  }, [currentTime, lrcLineList]);\n\n  useLayoutEffect(() => {\n    if (autoScroll) {\n      rootRef.current?.scrollTo({\n        left: 0,\n        top:\n          (lrcLineOffsetTopMap.get(currentIndex) || 0) -\n          (lrcLineOffsetTopMap.get(Infinity) || 0) / 2,\n        behavior: 'smooth',\n      });\n    }\n  }, [currentIndex, autoScroll]);\n  useEffect(() => {\n    if (onCurrentLineChange) {\n      onCurrentLineChange(lrcLineList[currentIndex] || null, currentIndex);\n    }\n  }, [currentIndex, lrcLineList, onCurrentLineChange]);\n\n  return (\n    <div {...props} ref={rootRef}>\n      <Blank />\n      {lrcLineList.map((lrcLine, index) =>\n        children(lrcLine, index === currentIndex, index),\n      )}\n      <Blank />\n    </div>\n  );\n};\n\nexport default Lrc;\n","import { useLayoutEffect, useState, RefObject, useEffect } from 'react';\n\nexport default ({\n  rootRef,\n  autoScrollAfterUserScroll,\n  scrollToCurrentLineSymbol,\n}: {\n  rootRef: RefObject<HTMLDivElement>;\n  autoScrollAfterUserScroll: number;\n  scrollToCurrentLineSymbol: number;\n}) => {\n  const [autoScroll, setAutoScroll] = useState(true);\n\n  useLayoutEffect(() => {\n    (rootRef.current as HTMLDivElement).style.overflow = 'auto';\n  }, []);\n\n  useLayoutEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n    const wheelListener = () => {\n      setAutoScroll(false);\n      clearTimeout(timer);\n      timer = setTimeout(() => setAutoScroll(true), autoScrollAfterUserScroll);\n    };\n    (rootRef.current as HTMLDivElement).addEventListener(\n      'wheel',\n      wheelListener,\n    );\n    return () =>\n      (rootRef.current as HTMLDivElement).removeEventListener(\n        'wheel',\n        wheelListener,\n      );\n  }, [autoScrollAfterUserScroll]);\n\n  useEffect(() => {\n    setAutoScroll(true);\n  }, [scrollToCurrentLineSymbol]);\n\n  return autoScroll;\n};\n","import { useState, useEffect } from 'react';\n\nimport { LrcLine } from '../type';\nimport parseLrc from '../util/parse_lrc';\n\nexport default (lrc: string) => {\n  const [lrcLineList, setLrcLineList] = useState<LrcLine[]>(parseLrc(lrc));\n\n  useEffect(() => {\n    setLrcLineList(parseLrc(lrc));\n  }, [lrc]);\n\n  return lrcLineList;\n};\n","import {\n  useRef,\n  useLayoutEffect,\n  RefObject,\n  useEffect,\n  useCallback,\n} from 'react';\nimport { LrcLine } from '../type';\n\nimport { LRC_LINE_CLASS_NAME, RESIZE_INTERVAL } from '../constant';\n\nexport default ({\n  lrcLineList,\n  rootRef,\n}: {\n  lrcLineList: LrcLine[];\n  rootRef: RefObject<HTMLDivElement>;\n}) => {\n  const map = useRef<Map<number, number>>(new Map());\n  const calculate = useCallback(() => {\n    map.current = new Map();\n    const lineList = document.querySelectorAll(`.${LRC_LINE_CLASS_NAME}`);\n    for (let i = 0, { length } = lineList; i < length; i += 1) {\n      const line = lineList[i] as HTMLDivElement;\n      map.current.set(i, line.offsetTop);\n    }\n    const rect = rootRef.current?.getBoundingClientRect();\n    map.current.set(Infinity, rect?.height || 0);\n  }, []);\n\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n    const windowResizeListener = () => {\n      clearTimeout(timer);\n      timer = setTimeout(calculate, RESIZE_INTERVAL);\n    };\n    window.addEventListener('resize', windowResizeListener);\n    return () => window.removeEventListener('resize', windowResizeListener);\n  }, [calculate]);\n\n  useLayoutEffect(() => {\n    calculate();\n  }, [lrcLineList]);\n\n  return map.current;\n};\n","import React, { PureComponent } from 'react';\n\nimport { LrcProps, LrcLine } from '../type';\nimport { ININIAL_LRC_LINE_INDEX } from '../constant';\n\nimport Lrc from './lrc';\n\nclass LrcWrapper extends PureComponent<\n  LrcProps,\n  {\n    scrollToCurrentLineSymbol: number;\n    currentLrcLine: LrcLine | null;\n    currentLrcLineIndex: number;\n  }\n> {\n  constructor(props: LrcProps) {\n    super(props);\n    this.state = {\n      scrollToCurrentLineSymbol: 0,\n      currentLrcLine: null,\n      currentLrcLineIndex: ININIAL_LRC_LINE_INDEX,\n    };\n    this.onCurrentLineChange = this.onCurrentLineChange.bind(this);\n  }\n\n  scrollToCurrentLine() {\n    this.setState({ scrollToCurrentLineSymbol: Math.random() });\n  }\n\n  getCurrentLine(): {\n    lrcLine: LrcLine | null;\n    index: number;\n  } {\n    const { currentLrcLine, currentLrcLineIndex } = this.state;\n    return {\n      lrcLine: currentLrcLine,\n      index: currentLrcLineIndex,\n    };\n  }\n\n  private onCurrentLineChange(lrcLine: LrcLine, index: number) {\n    const { onCurrentLineChange } = this.props;\n    this.setState(\n      {\n        currentLrcLine: lrcLine,\n        currentLrcLineIndex: index,\n      },\n      () => {\n        if (onCurrentLineChange) {\n          onCurrentLineChange(lrcLine, index);\n        }\n      },\n    );\n  }\n\n  render() {\n    const { scrollToCurrentLineSymbol } = this.state;\n    return (\n      <Lrc\n        {...this.props}\n        onCurrentLineChange={this.onCurrentLineChange}\n        scrollToCurrentLineSymbol={scrollToCurrentLineSymbol}\n      />\n    );\n  }\n}\n\nexport default LrcWrapper;\n","import React from 'react';\n\nimport { LRC_LINE_CLASS_NAME } from '../constant';\n\nconst LrcLine = ({\n  className = '',\n  ...props\n}: {\n  className?: string;\n  [key: string]: any;\n}) => {\n  return (\n    <div {...props} className={`${LRC_LINE_CLASS_NAME} ${className}`}>\n      {props.children}\n    </div>\n  );\n};\n\nexport default LrcLine;\n","import React, { useRef, useCallback } from 'react';\nimport { Lrc, LrcLine } from '@mebtte/react-lrc';\n\nconst style = {\n  wrapper: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  lrc: {\n    flex: 1,\n    padding: 20,\n  },\n  line: {\n    textAlign: 'center',\n    padding: 10,\n    fontSize: 16,\n  },\n};\n\nconst Wrapper = ({ music, currentTime }) => {\n  const lrcRef = useRef();\n  const scrollToCurrentLine = useCallback(\n    () => lrcRef.current.scrollToCurrentLine(),\n    [],\n  );\n  const getCurrentLine = useCallback(() => {\n    // eslint-disable-next-line no-undef\n    alert(JSON.stringify(lrcRef.current.getCurrentLine()));\n  }, []);\n  const onCurrentLineChange = useCallback((lrcLine, index) => {\n    console.log('\\n');\n    console.log(lrcLine, index);\n  }, []);\n\n  return (\n    <div style={style.wrapper}>\n      <div className=\"actions\">\n        <button type=\"button\" onClick={scrollToCurrentLine}>\n          scroll to current line\n        </button>\n        <button type=\"button\" onClick={getCurrentLine}>\n          alert current line\n        </button>\n      </div>\n      <Lrc\n        lrc={music.lrc}\n        currentTime={currentTime * 1000}\n        onCurrentLineChange={onCurrentLineChange}\n        style={style.lrc}\n        ref={lrcRef}\n      >\n        {(line, active) => (\n          <LrcLine\n            key={line.millisecond}\n            style={{\n              ...style.line,\n              color: active ? 'red' : 'gray',\n            }}\n          >\n            {line.content}\n          </LrcLine>\n        )}\n      </Lrc>\n    </div>\n  );\n};\n\nexport default Wrapper;\n","import React, { useState, useCallback } from 'react';\n\nimport musicList from './data';\nimport style from './style';\n\nimport Music from './music';\nimport Audio from './audio';\nimport Lyric from './lyric';\n\nconst App = () => {\n  const [index, setIndex] = useState(0);\n  const onPrevious = useCallback(\n    () =>\n      setIndex((i) => {\n        const target = i - 1;\n        if (target < 0) {\n          return target + musicList.length;\n        }\n        return target;\n      }),\n    [],\n  );\n  const onNext = useCallback(\n    () => setIndex((i) => (i + 1) % musicList.length),\n    [],\n  );\n  const [currentTime, setCurrentTime] = useState(0);\n  const onTimeUpdate = useCallback(\n    (event) => setCurrentTime(event.target.currentTime),\n    [],\n  );\n\n  const music = musicList[index];\n  return (\n    <div style={style.container}>\n      <div style={style.part}>\n        {musicList.map((m, i) => (\n          <Music\n            key={m.id}\n            music={m}\n            playing={i === index}\n            onPlay={() => setIndex(i)}\n          />\n        ))}\n        <Audio\n          music={music}\n          onPrevious={onPrevious}\n          onNext={onNext}\n          onTimeUpdate={onTimeUpdate}\n        />\n      </div>\n      <Lyric music={music} currentTime={currentTime} />\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}